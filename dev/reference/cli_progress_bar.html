<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>cli progress bars — cli_progress_bar • cli</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="cli progress bars — cli_progress_bar"><meta name="description" content="This is the reference manual of the three functions that create,
update and terminate progress bars. For a tutorial see the
cli progress bars.
cli_progress_bar() creates a new progress bar.
cli_progress_update() updates the state of a progress bar, and
potentially the display as well.
cli_progress_done() terminates a progress bar."><meta property="og:description" content="This is the reference manual of the three functions that create,
update and terminate progress bars. For a tutorial see the
cli progress bars.
cli_progress_bar() creates a new progress bar.
cli_progress_update() updates the state of a progress bar, and
potentially the display as well.
cli_progress_done() terminates a progress bar."><meta name="robots" content="noindex"><script defer data-domain="cli.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cli</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">3.6.4.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../reference/faq.html">FAQ</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/semantic-cli.html">Building a Semantic CLI</a></li>
    <li><a class="dropdown-item" href="../articles/usethis-ui.html">From usethis::ui functions to cli</a></li>
    <li><a class="dropdown-item" href="../articles/pluralization.html">cli pluralization</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Progress bars</h6></li>
    <li><a class="dropdown-item" href="../articles/progress.html">Introduction to progress bars in cli</a></li>
    <li><a class="dropdown-item" href="../articles/progress-advanced.html">Advanced cli progress bars</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Customization</h6></li>
    <li><a class="dropdown-item" href="../articles/palettes.html">cli color palettes</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-lib/cli/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>cli progress bars</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-lib/cli/blob/main/R/progress-client.R" class="external-link"><code>R/progress-client.R</code></a></small>
      <div class="d-none name"><code>cli_progress_bar.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is the reference manual of the three functions that create,
update and terminate progress bars. For a tutorial see the
<a href="https://cli.r-lib.org/articles/progress.html">cli progress bars</a>.</p>
<p><code>cli_progress_bar()</code> creates a new progress bar.</p>
<p><code>cli_progress_update()</code> updates the state of a progress bar, and
potentially the display as well.</p>
<p><code>cli_progress_done()</code> terminates a progress bar.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cli_progress_bar</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  status <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"iterator"</span>, <span class="st">"tasks"</span>, <span class="st">"download"</span>, <span class="st">"custom"</span><span class="op">)</span>,</span>
<span>  total <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  format <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  format_done <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  format_failed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clear <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"cli.progress_clear"</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  current <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  auto_terminate <span class="op">=</span> <span class="va">type</span> <span class="op">!=</span> <span class="st">"download"</span>,</span>
<span>  extra <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  .auto_close <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cli_progress_update</span><span class="op">(</span></span>
<span>  inc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  set <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  total <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  status <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  extra <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  force <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  .envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cli_progress_done</span><span class="op">(</span>id <span class="op">=</span> <span class="cn">NULL</span>, .envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span>, result <span class="op">=</span> <span class="st">"done"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>This is typically used as a label, and should be short,
at most 20 characters.</p></dd>


<dt id="arg-status">status<a class="anchor" aria-label="anchor" href="#arg-status"></a></dt>
<dd><p>New status string of the progress bar, if not <code>NULL</code>.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Type of the progress bar. It is used to select a default
display if <code>format</code> is not specified. Currently supported types:</p><ul><li><p><code>iterator</code>: e.g. a for loop or a mapping function,</p></li>
<li><p><code>tasks</code>: a (typically small) number of tasks,</p></li>
<li><p><code>download</code>: download of one file,</p></li>
<li><p><code>custom</code>: custom type, <code>format</code> must not be <code>NULL</code> for this type.</p></li>
</ul></dd>


<dt id="arg-total">total<a class="anchor" aria-label="anchor" href="#arg-total"></a></dt>
<dd><p>Total number of progress units, or <code>NA</code> if it is unknown.
<code>cli_progress_update()</code> can update the total number of units. This is
handy if you don't know the size of a download at the beginning, and
also in some other cases. If <code>format</code> is set to <code>NULL</code>, <code>format</code> (plus
<code>format_done</code> and <code>format_failed</code>) will be updated when you change
<code>total</code> from <code>NA</code> to a number. I.e. default format strings will be
updated, custom ones won't be.</p></dd>


<dt id="arg-format">format<a class="anchor" aria-label="anchor" href="#arg-format"></a></dt>
<dd><p>Format string. It has to be specified for custom progress
bars, otherwise it is optional, and a default display is selected
based on the progress bat type and whether the number of total units
is known. Format strings may contain glue substitution, the support
pluralization and cli styling. See <a href="progress-variables.html">progress-variables</a> for special
variables that you can use in the custom format.</p></dd>


<dt id="arg-format-done">format_done<a class="anchor" aria-label="anchor" href="#arg-format-done"></a></dt>
<dd><p>Format string for successful termination. By default
the same as <code>format</code>.</p></dd>


<dt id="arg-format-failed">format_failed<a class="anchor" aria-label="anchor" href="#arg-format-failed"></a></dt>
<dd><p>Format string for unsuccessful termination. By
default the same as <code>format</code>.</p></dd>


<dt id="arg-clear">clear<a class="anchor" aria-label="anchor" href="#arg-clear"></a></dt>
<dd><p>Whether to remove the progress bar from the screen after
it has terminated. Defaults to the <code>cli.progress_clear</code> option, or
<code>TRUE</code> if unset.</p></dd>


<dt id="arg-current">current<a class="anchor" aria-label="anchor" href="#arg-current"></a></dt>
<dd><p>Whether to use this progress bar as the current progress
bar of the calling function. See more at 'The current progress bar'
below.</p></dd>


<dt id="arg-auto-terminate">auto_terminate<a class="anchor" aria-label="anchor" href="#arg-auto-terminate"></a></dt>
<dd><p>Whether to terminate the progress bar if the
number of current units reaches the number of total units.</p></dd>


<dt id="arg-extra">extra<a class="anchor" aria-label="anchor" href="#arg-extra"></a></dt>
<dd><p>Extra data to add to the progress bar. This can be
used in custom format strings for example. It should be a named list.
<code>cli_progress_update()</code> can update the extra data. Often you can get
away with referring to local variables in the format string, and
then you don't need to use this argument. Explicitly including these
constants or variables in <code>extra</code> can result in cleaner code. In
the rare cases when you need to refer to the same progress bar from
multiple functions, and you can them to <code>extra</code>.</p></dd>


<dt id="arg--auto-close">.auto_close<a class="anchor" aria-label="anchor" href="#arg--auto-close"></a></dt>
<dd><p>Whether to terminate the progress bar when the
calling function (or the one with execution environment in <code>.envir</code>
exits. (Auto termination does not work for progress bars created
from the global environment, e.g. from a script.)</p></dd>


<dt id="arg--envir">.envir<a class="anchor" aria-label="anchor" href="#arg--envir"></a></dt>
<dd><p>The environment to use for auto-termination and for glue
substitution. It is also used to find and set the current progress bar.</p></dd>


<dt id="arg-inc">inc<a class="anchor" aria-label="anchor" href="#arg-inc"></a></dt>
<dd><p>Increment in progress units. This is ignored if <code>set</code> is
not <code>NULL</code>.</p></dd>


<dt id="arg-set">set<a class="anchor" aria-label="anchor" href="#arg-set"></a></dt>
<dd><p>Set the current number of progress units to this value.
Ignored if <code>NULL</code>.</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>Progress bar to update or terminate. If <code>NULL</code>, then the
current progress bar of the calling function (or <code>.envir</code> if
specified) is updated or terminated.</p></dd>


<dt id="arg-force">force<a class="anchor" aria-label="anchor" href="#arg-force"></a></dt>
<dd><p>Whether to force a display update, even if no update is
due.</p></dd>


<dt id="arg-result">result<a class="anchor" aria-label="anchor" href="#arg-result"></a></dt>
<dd><p>String to select successful or unsuccessful termination.
It is only used if the progress bar is not cleared from the screen.
It can be one of <code>"done"</code>, <code>"failed"</code>, <code>"clear"</code>, and <code>"auto"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>cli_progress_bar()</code> returns the id of the new progress bar.
The id is a string constant.</p>
<p><code>cli_progress_update()</code> returns the id of the progress bar,
invisibly.</p>
<p><code>cli_progress_done()</code> returns <code>TRUE</code>, invisibly, always.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="basic-usage">Basic usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a></h3>


<p><code>cli_progress_bar()</code> creates a progress bar, <code>cli_progress_update()</code>
updates an existing progress bar, and <code>cli_progress_done()</code> terminates
it.</p>
<p>It is good practice to always set the <code>name</code> argument, to make the
progress bar more informative.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">clean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_bar</a></span><span class="op">(</span><span class="st">"Cleaning data"</span>, total <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">5</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_update</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_done</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">clean</span><span class="op">(</span><span class="op">)</span></span></code></pre><p></p></div>
<p><img src="figures/progress-1.svg" alt=""></p>
</div>

<div class="section">
<h3 id="progress-bar-types">Progress bar types<a class="anchor" aria-label="anchor" href="#progress-bar-types"></a></h3>


<p>There are three builtin types of progress bars, and a custom type.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">tasks</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_bar</a></span><span class="op">(</span><span class="st">"Tasks"</span>, total <span class="op">=</span> <span class="fl">3</span>, type <span class="op">=</span> <span class="st">"tasks"</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_update</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_done</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">tasks</span><span class="op">(</span><span class="op">)</span></span></code></pre><p></p></div>
<p><img src="figures/progress-tasks.svg" alt=""></p>
</div>

<div class="section">
<h3 id="unknown-total">Unknown <code>total</code><a class="anchor" aria-label="anchor" href="#unknown-total"></a></h3>


<p>If <code>total</code> is not known, then cli shows a different progress bar.
Note that you can also set <code>total</code> in <code>cli_progress_update()</code>, if it
not known when the progress bar is created, but you learn it later.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">nototal</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_bar</a></span><span class="op">(</span><span class="st">"Parameter tuning"</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">3</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_update</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_done</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">nototal</span><span class="op">(</span><span class="op">)</span></span></code></pre><p></p></div>
<p><img src="figures/progress-natotal.svg" alt=""></p>
</div>

<div class="section">
<h3 id="clearing-the-progress-bar">Clearing the progress bar<a class="anchor" aria-label="anchor" href="#clearing-the-progress-bar"></a></h3>


<p>By default cli removes terminated progress bars from the screen, if
the terminal supports this. If you want to change this, use the
<code>clear</code> argument of <code>cli_progress_bar()</code>, or the <code>cli.progress_clear</code>
global option (see <a href="cli-config.html">cli-config</a>) to change this.</p>
<p>(In the cli documentation we usually set <code>cli.progress_clear</code> to <code>FALSE</code>,
so users can see how finished progress bars look.)</p>
<p>In this example the first progress bar is cleared, the second is not.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_bar</a></span><span class="op">(</span><span class="st">"Data cleaning"</span>, total <span class="op">=</span> <span class="fl">100</span>, clear <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">3</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_update</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_bar</a></span><span class="op">(</span><span class="st">"Parameter tuning"</span>, total <span class="op">=</span> <span class="fl">100</span>, clear <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">3</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_update</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">fun</span><span class="op">(</span><span class="op">)</span></span></code></pre><p></p></div>
<p><img src="figures/progress-clear.svg" alt=""></p>
</div>

<div class="section">
<h3 id="initial-delay">Initial delay<a class="anchor" aria-label="anchor" href="#initial-delay"></a></h3>


<p>Updating a progress bar on the screen is costly, so cli tries to avoid
it for quick loops. By default a progress bar is only shown after two
seconds, or after half of that if less than 50% of the iterations are
complete. You can change the two second default with the
<code>cli.progress_show_after</code> global option (see <a href="cli-config.html">cli-config</a>).</p>
<p>(In the cli documentation we usually set <code>cli.progress_show_after</code> to
<code>0</code> (zero seconds), so progress bars are shown immediately.)</p>
<p>In this example we only show the progress bar after one second, because
more than 50% of the iterations remain after one second.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/cli_alert.html">cli_alert</a></span><span class="op">(</span><span class="st">"Starting now, at {Sys.time()}"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_bar</a></span><span class="op">(</span></span>
<span>    total <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    format <span class="op">=</span> <span class="st">"{cli::pb_bar} {pb_percent} @ {Sys.time()}"</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">4</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_update</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>cli.progress_show_after <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">fun</span><span class="op">(</span><span class="op">)</span></span></code></pre><p></p></div>
<p><img src="figures/progress-after.svg" alt=""></p>
</div>

<div class="section">
<h3 id="the-current-progress-bar">The <em>current</em> progress bar<a class="anchor" aria-label="anchor" href="#the-current-progress-bar"></a></h3>


<p>By default cli sets the new progress bar as the <em>current</em> progress bar
of the calling function. The current progress bar is the default one
in cli progress bar operations. E.g. if no progress bar id is supplied
in <code>cli_progress_update()</code>, then the current progress bar is updated.</p>
<p>Every function can only have a single <em>current</em> progress bar, and if a
new one is created, then the previous one (if any) is automatically
terminated. The current progress bar is also terminated when the function
that created it exits. Thanks to these rules, most often you don't need
to explicitly deal with progress bar ids, and you don't need to
explicitly call <code>cli_progress_done()</code>:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_bar</a></span><span class="op">(</span><span class="st">"First step "</span>, total <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">2</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_update</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_bar</a></span><span class="op">(</span><span class="st">"Second step"</span>, total <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">2</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_update</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">fun</span><span class="op">(</span><span class="op">)</span></span></code></pre><p></p></div>
<p><img src="figures/progress-current.svg" alt=""></p>
</div>

<div class="section">
<h3 id="cli-output-while-the-progress-bar-is-active">cli output while the progress bar is active<a class="anchor" aria-label="anchor" href="#cli-output-while-the-progress-bar-is-active"></a></h3>


<p>cli allows emitting regular cli output (alerts, headers, lists, etc.)
while a progress bar is active. On terminals that support this, cli
will remove the progress bar temporarily, emit the output, and then
restores the progress bar.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/cli_alert.html">cli_alert_info</a></span><span class="op">(</span><span class="st">"Before the progress bar"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_bar</a></span><span class="op">(</span><span class="st">"Calculating"</span>, total <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">4</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_update</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="../reference/cli_alert.html">cli_alert_info</a></span><span class="op">(</span><span class="st">"Already half way!"</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">4</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_update</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="../reference/cli_alert.html">cli_alert_info</a></span><span class="op">(</span><span class="st">"All done"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">fun</span><span class="op">(</span><span class="op">)</span></span></code></pre><p></p></div>
<p><img src="figures/progress-output.svg" alt=""></p>
<p>See also <code><a href="cli_progress_output.html">cli_progress_output()</a></code>, which sends text for the current
progress handler. E.g. in a Shiny app it will send the output to the
Shiny progress bar, as opposed to the <code><a href="cli_alert.html">cli_alert()</a></code> etc. cli functions
which will print the text to the console.</p>
</div>

<div class="section">
<h3 id="custom-formats">Custom formats<a class="anchor" aria-label="anchor" href="#custom-formats"></a></h3>


<p>In addition to the builtin types, you can also specify a custom
format string. In this case <a href="progress-variables.html">progress variables</a>
are probably useful to avoid calculating some progress bar quantities
like the elapsed time, of the ETA manually. You can also use your own
variables in the calling function:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">urls</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_bar</a></span><span class="op">(</span></span>
<span>    format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>      <span class="st">"{pb_spin} Downloading {.path {basename(url)}} "</span>,</span>
<span>      <span class="st">"[{pb_current}/{pb_total}]   ETA:{pb_eta}"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    format_done <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>      <span class="st">"{col_green(symbol$tick)} Downloaded {pb_total} files "</span>,</span>
<span>      <span class="st">"in {pb_elapsed}."</span></span>
<span>    <span class="op">)</span>,,</span>
<span>    total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">urls</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">url</span> <span class="kw">in</span> <span class="va">urls</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/cli_progress_bar.html">cli_progress_update</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">5</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">fun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"https://acme.com/data-"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="st">".zip"</span><span class="op">)</span><span class="op">)</span></span></code></pre><p></p></div>
<p><img src="figures/progress-format.svg" alt=""></p>
</div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>These functions support <a href="inline-markup.html">inline markup</a>.</p>
<p><code><a href="cli_progress_message.html">cli_progress_message()</a></code> and <code><a href="cli_progress_step.html">cli_progress_step()</a></code> for simpler
progress messages.</p>
<p>Other progress bar functions:
<code><a href="cli_progress_along.html">cli_progress_along</a>()</code>,
<code><a href="cli_progress_builtin_handlers.html">cli_progress_builtin_handlers</a>()</code>,
<code><a href="cli_progress_message.html">cli_progress_message</a>()</code>,
<code><a href="progress-utils.html">cli_progress_num</a>()</code>,
<code><a href="cli_progress_output.html">cli_progress_output</a>()</code>,
<code><a href="cli_progress_step.html">cli_progress_step</a>()</code>,
<code><a href="cli_progress_styles.html">cli_progress_styles</a>()</code>,
<code><a href="progress-variables.html">progress-variables</a></code></p>
<p>Other functions supporting inline markup:
<code><a href="cli_abort.html">cli_abort</a>()</code>,
<code><a href="cli_alert.html">cli_alert</a>()</code>,
<code><a href="cli_blockquote.html">cli_blockquote</a>()</code>,
<code><a href="cli_bullets.html">cli_bullets</a>()</code>,
<code><a href="cli_bullets_raw.html">cli_bullets_raw</a>()</code>,
<code><a href="cli_dl.html">cli_dl</a>()</code>,
<code><a href="cli_h1.html">cli_h1</a>()</code>,
<code><a href="cli_li.html">cli_li</a>()</code>,
<code><a href="cli_ol.html">cli_ol</a>()</code>,
<code><a href="cli_process_start.html">cli_process_start</a>()</code>,
<code><a href="cli_progress_along.html">cli_progress_along</a>()</code>,
<code><a href="cli_progress_message.html">cli_progress_message</a>()</code>,
<code><a href="cli_progress_output.html">cli_progress_output</a>()</code>,
<code><a href="cli_progress_step.html">cli_progress_step</a>()</code>,
<code><a href="cli_rule.html">cli_rule</a></code>,
<code><a href="cli_status.html">cli_status</a>()</code>,
<code><a href="cli_status_update.html">cli_status_update</a>()</code>,
<code><a href="cli_text.html">cli_text</a>()</code>,
<code><a href="cli_ul.html">cli_ul</a>()</code>,
<code><a href="format_error.html">format_error</a>()</code>,
<code><a href="format_inline.html">format_inline</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gaborcsardi" class="external-link">Gábor Csárdi</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer></body></html>

